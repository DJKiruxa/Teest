<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src='js/jquery-2.1.4.min.js'></script>
    <script src="js/jquery.cookie.js"></script>
    <link href="zTree_v3/css/zTreeStyle/zTreeStyle.css" rel="stylesheet" />
    <script type="text/javascript" src="zTree_v3/js/jquery.ztree.core.js"></script>
    <script type="text/javascript" src="zTree_v3/js/jquery.ztree.excheck.js"></script>
    <script type="text/javascript">
        if ("ontouchend" in document) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
	<title>Intelligent Monitoring System</title>
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
    <script src="assets/js/bootstrap.min.js"></script>

    <!--bootstrap table-->
    <link rel="stylesheet" type="text/css" href="css/bootstrap-table/bootstrap-table.css">
    <script type="text/javascript" src="css/bootstrap-table/bootstrap-table.js"></script>


    <!-- fontawesome -->
    <link rel="stylesheet" href="css/font-awesome-4.7.0/css/font-awesome.min.css" />

    <!-- jqgrid -->
    <link rel="stylesheet" href="assets/css/ui.jqgrid.css" />

    <!-- ace scripts -->

	
    <link rel="stylesheet" href="assets/css/ace.min.css" />
    <link rel="stylesheet" href="assets/css/ace-rtl.min.css" />
    <link rel="stylesheet" href="assets/css/ace-skins.min.css" />
    <script src="assets/js/ace-elements.min.js"></script>
    <script src="assets/js/ace.min.js"></script>
    <script src="assets/js/ace.ajax-content.js"></script>
    <script src="assets/js/ace-extra.min.js"></script>
    <script src="assets/js/fuelux/fuelux.spinner.min.js"></script>

    <script src="assets/js/jqGrid/i18n/grid.locale-en.js"></script>
    <script src="assets/js/jqGrid/jquery.jqGrid.min.js"></script>



    <!--layer-->
    <script src="css/layer/layer.js"></script>
	<script type="text/javascript" src="js/crypto-js.min.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript" src="js/commonFunction.js"></script>
	<script type="text/javascript" src="js/base64.js"></script>
    <script type="text/javascript" src="js/serverInfoService.js"></script>
    <script type="text/javascript" src="js/md5.js"></script>
    <script type="text/javascript" src="js/deviceCache.js"></script>
	<script type="text/javascript" src="js/fileOperation.js"></script>
	<script type="text/javascript" src="js/crc.js"></script>
    <script type="text/javascript" src="js/pagejs/devmete.js"></script>

    <script src="js/exceljs/cpexcel.js"></script>
    <script src="js/exceljs/shim.js"></script>
    <script src="js/exceljs/jszip.js"></script>
    <script src="js/exceljs/xlsx.js"></script>
    <script src="js/exceljs/ExcelRead.js"></script>
    <style type="text/css">
        .sidebar {
            margin-top: 0px;
        }

        .sidebar {
            position: fixed !important;
            overflow-y: scroll;
            display: none;
        }

        .main-container {
            margin-top: 50px;
        }

        .layui-layer-title {
            font-size: 20px;
            color: #e8b213;
            text-align: center;
            background-color: #bbddf1
        }
		@media screen and (max-width: 767px) { 
			.navbar-collapse{
				position:relative;
			}
			.navbar .navbar-header.pull-right{
				   position: absolute !important;
				right: 10px !important;
				top: -42px !important;
			}
			.ace-nav > li{
				height:40px !important;
			}
			.collapse{
				display:block !important;
			}
			#mainNavUl{
				height:0px;
				 overflow: hidden;
				overflow-y: auto;
				display:none;
				
			}
			#panelDiv{
				display:block !important;
			}
			#main-container{
				margin-top:75px;
			}
		}
    </style>
</head>

<body>
<div class="navbar navbar-default navbar-fixed-top" id="navbar">
    <script type="text/javascript">
        try {
            ace.settings.check('navbar', 'fixed')
        } catch (e) {
        }
    </script>

    <div class="navbar-container" id="navbar-container">
        <div class="navbar-header pull-left">
            <a data-url="overview.html" href="#overview.html" class="navbar-brand" >
                <small>
                    <i class="icon-leaf"></i>
					<!--<img src ="./images/rqlogo.png"  />-->
                    Intelligent Monitoring System
                </small>
            </a>
        </div><!-- /.navbar-header -->
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="mainNav">
			<div class="panel-heading" id="panelDiv" style="display:none" >
				<h4 class="panel-title">
					<i class="ace-icon fa fa-angle-down bigger-110" data-icon-hide="ace-icon fa fa-angle-down" data-icon-show="ace-icon fa fa-angle-down" id="panelDown" style="display:none"></i>
					<i class="ace-icon fa fa-angle-right bigger-110" data-icon-hide="ace-icon fa fa-angle-right" data-icon-show="ace-icon fa fa-angle-right" id="panelUp" style="display:block"></i>
				</h4>
			</div>

            <ul class="nav navbar-nav" id="mainNavUl">
            </ul>
            <div class="navbar-header pull-right" role="navigation">
                <ul class="nav ace-nav">
                    <li class="yellow active" >
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#" aria-expanded="false">
                            <i class="ace-icon fa fa-bell"></i>
                            <span class="badge badge-important alarmNowSum"></span>
                        </a>

                        <ul class="pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                            <li class="dropdown-header">
                                <i class="ace-icon fa fa-bell icon-animated-bell"></i>
                                <span class="alarmNowSum"></span><font id="untreatedAlarm"> real-time alarms</font>
                            </li>

                            <li class="dropdown-footer active">
                                <a data-url="alarmPages/alarmViewNoClose.html" href="#pages/alarm.html">
                                    <font id="showAlarmDetail">view alarm details</font>
                                    <i class="ace-icon fa fa-bell icon-animated-bell"></i>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="light-blue">
                        <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                            <img class="nav-user-photo" src="assets/avatars/avatar2.png"/>

                            <i class="icon-caret-down"></i>
                        </a>

                        <ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                            <li>
                                <a href="#" onclick="onPswdModify()">
                                    <i class="icon-cog"></i>
                                    Change password
                                </a>
                                <a href="index.html">
                                    <i class="icon-off"></i>
                                    Sign out
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul><!-- /.ace-nav -->
            </div><!-- /.navbar-header -->
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</div>

<div class="main-container" id="main-container">
    <script type="text/javascript">
        try {
            ace.settings.check('main-container', 'fixed')
        } catch (e) {
        }
    </script>

   <!-- <div class="main-container-inner">-->
        <div id="sidebar" class="sidebar responsive ace-save-state">
            <script type="text/javascript">
                try {
                    ace.settings.check('sidebar', 'fixed')
                } catch (e) {
                }
            </script>


            <ul class="nav nav-list" id="devListUl">
            </ul><!-- /.nav-list -->

            <script type="text/javascript">
                try {
                    ace.settings.check('sidebar', 'collapsed')
                } catch (e) {
                }
            </script>
        </div>

        <div class="main-content">
            <div class="page-content">
                <div class="page-content-area" style="opacity: 1; " data-ajax-content="true">
                </div>
            </div><!-- /.page-content data-ajax-content="true"-->
        </div><!-- /.main-content -->
    <!--</div>--><!-- /.main-container-inner -->
</div><!-- /.main-container -->
<script type="text/javascript" src="js/start.js"></script>
<script type="text/javascript">
    deviceCacheService.init();
    function getParam(name, target) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = target.match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }
	var _mobleNav=document.getElementById("panelDiv");
	_mobleNav.addEventListener("click",panelFun,false);
	function panelFun(){
		if($("#mainNavUl").css("height")!='0px'){
				$("#mainNavUl").hide();
				$("#mainNavUl").css({'height':'0px'});
				$("#panelUp").show();
				$("#panelDown").hide();
			}else{
				$("#mainNavUl").show();
				//$("#main-container").css({'margin-top':'100px'});
				$("#mainNavUl").css({'height':'200px'});
				$("#panelDown").show();
				$("#panelUp").hide();
			}
		//$("#panelDiv").click(function(){
		//console.log("70")
			
		//})
	}

    var paramBase64 = location.search;
    paramBase64 = paramBase64.substring(1);
    if (cookieEnable()) {
        var paramBase64 = $.cookie("msjParams");
		var paramBase64 = CryptoJS.DES.decrypt(paramBase64, CryptoJS.enc.Utf8.parse("comeback"), {
		  mode: CryptoJS.mode.ECB,
		  padding: CryptoJS.pad.Pkcs7
		}).toString(CryptoJS.enc.Utf8);
    }
	
    var param = paramBase64; //base64decode(paramBase64);
    var name = getParam("name", param);
    var password = getParam("pwd", param);
    serverInfoService.username = name;
    serverInfoService.password = password;

    function onPswdModify() {
        $.ajax({
            url: "pages/modifyPswd.html",
            global: false,
            type: "GET",
            dataType: "html",
            async: false,
            success: function (msg) {
                var layerIndex = layer.open({
                    type: 1,
                    title: 'Change password',
                    area: ['400px', '400px'],
                    content: msg
                });
            }
        });

    }

    function onProtocolManager() {
        $.ajax({
            url: "pages/protocolManager.html",
            global: false,
            type: "GET",
            dataType: "html",
            async: false,
            success: function (msg) {
                var layerIndex = layer.open({
                    type: 1,
                    title: 'Protocol management',
                    area: ['500px', '500px'],
                    content: msg
                });
            }
        });
    }



    function pswdGuide() {
        /*var pswdFlag = sessionStorage.getItem("key")
        if (pswdFlag == null) {
            window.sessionStorage.setItem('key', 1);*/
        if (serverInfoService.password === "admin") {
            if ($.cookie("modifyTipFlag") == "1") {
                return;
            }
            $.cookie("modifyTipFlag", "1");
            $.ajax({
                url: "pages/prompt.html",
                global: false,
                type: "GET",
                dataType: "html",
                async: false,
                success: function (msg) {
                    var layerIndex = layer.open({
                        type: 1,
                        title: 'Safety tips!',
                        area: ['400px', '400px'],
                        content: msg
                    });
                }
            });
        }
        //}

    }
</script>
</body>
</html>
